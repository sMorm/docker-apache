version: 0.2

phases:
    pre_build:
        commands:
            - echo Logging into ECR...
            - $(docker login -u AWS -p eyJwYXlsb2FkIjoib0FhK0duMGMwS1A0bmh4QXpST0F2cGRzem1IdUlqdFRPMnMrNUdTL0prV3lsY2UwRHBVYm1FbGVDV1hBRElxYk1JenhwQ3JKV09uSDRES0QyMURBN1RLK2lTYk9URG9oU0U4MkZXdHRFa2dSZmhTWTBLVWMyNmh5OVM0cUZ4dHgrT0I4dDRuMitiYmNRVHoycU05c1I1V1A5cGEyUXdQUzY2Qmt2b2pLdXhiMUhWRVZWTHQ2OHZxOWMwb1lEbklGbkZ2RUVzSUQrY2puR2puS1JDQ2xTS0s5bkFoQUk0dDlxbDR5blVSTDlnbnU5Snl2OFZ1UlVGUzMwRWN5TWtTeGxidnZmV2tOdzZmMDYzci81cmhIRmNHaEFuTGJHc0Y4TnVJcFUra0pqQTk5aWE5WW13TWU3bnJlc1VnOTlxdGVHbFVkcUhJblBEQUgvam9IK3dNTXRRRENSSG9BTFdwblpVKzQ2OW5aWFkyeDNxN2xQK1Q2TUY1c1o5dHBhUEt3d2ZLQTVVcGJrZUJlS3Y0ekpoOEJiK0g2UElwL2RtZGtHQkRwN2xoR0VhYkpjTmREemFxS3RpdVhyR0ZzcEI2YWlyN1NIOGMrNTR4UXlzT3lzV0FxLzR4VHpsak9jUXkyS2RVaUdQN2ppNlNjV2VOb2dvMVdmWnEzbE1wTThmZksrYzB3Uld0eHBzdHd0Q0tsc2VOaTVhYXFlcDlwc3o1RjIzSDFYZGNpMDBPQmswQ1Zjcnhqbm11K0tOcHhUMWg3aVprNXdqSk9JQ1cyQUxNRGlSMUtNemNkaXhtanFaenNNaDIxNmV0VDRhbkdRN2FDVmRMVm5xWWhGc21YdFhmK0NTMTArK0JJZzFKa1JkazFoSGQzN1dVNElNa0kyUlNqL3NpZjEyWmQ2clVEbHdWZWV3blNPSEtOVkdyMmNqQ1g0eXk1eU9pVVhQQWRKVGtVenBHUCtWd2d6UkZzelZNbThGVWpQaXNVMVM4aWtSWXFVbk9WcktFdzJlRU0vRDJqZmRuVU0yZEcrV0JFYjZhUXVvN0hLZkJ4d0ZHVVRkL0MwNGk3akNsM2dSZ2NBVGJxb2VUT05zbVFFUGlLV01odVhoV2orbHBCK2tFVmt3dmRoYU9QbXdybzk3UW1XdDZOWWF1ajcrMzh3a3UrdmFITUlEa0RXMlVyeXZzU3ovMEE4ZnQ2aGx0NjBSdk8vOGJENzlBWG9KTFYzbGtVcW9ZcnBicjFQZ3NuM3F3bzhoQ1FjL01JWjlUd2s2NzRCYzJwa2ZhUlFtYz0iLCJkYXRha2V5IjoiQVFFQkFIaHdtMFlhSVNKZVJ0Sm01bjFHNnVxZWVrWHVvWFhQZTVVRmNlOVJxOC8xNHdBQUFINHdmQVlKS29aSWh2Y05BUWNHb0c4d2JRSUJBREJvQmdrcWhraUc5dzBCQndFd0hnWUpZSVpJQVdVREJBRXVNQkVFRFBrcTg2bSt1ZE5RcHcydU1BSUJFSUE3T21LVmx5REVTdGNycTFDbWsxV2JJcFB4Skl2YlBMSjM1c24xTDJZMXZLYm5UcUtuZzRVODdOVnZBWlJKczJZWmxWM2wrL1ZGdUpKMGhhZz0iLCJ2ZXJzaW9uIjoiMSIsInR5cGUiOiJEQVRBX0tFWSJ9 https://466336452057.dkr.ecr.us-east-1.amazonaws.com)
    build:
        commands:
            - echo Building Docker Image
            - docker build -t php-test .
            - docker tag php-test:latest 466336452057.dkr.ecr.us-east-1.amazonaws.com/php-test:latest
    post_build:
        commands:
            - echo Build completed, pushing Image to ECR
            - docker push 466336452057.dkr.ecr.us-east-1.amazonaws.com/php-test:latest
